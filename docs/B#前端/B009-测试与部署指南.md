# æµ‹è¯•ä¸éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›äº†å‰ç«¯é¡¹ç›®çš„æµ‹è¯•å’Œéƒ¨ç½²å®Œæ•´æŒ‡å—ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ„å»ºä¼˜åŒ–å’Œéƒ¨ç½²æµç¨‹ã€‚

## ğŸ§ª æµ‹è¯•

### æµ‹è¯•æ¡†æ¶

- **Jest**: æµ‹è¯•è¿è¡Œå™¨å’Œæ–­è¨€åº“
- **React Testing Library**: React ç»„ä»¶æµ‹è¯•
- **@testing-library/user-event**: ç”¨æˆ·äº¤äº’æ¨¡æ‹Ÿ

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# CI ç¯å¢ƒè¿è¡Œæµ‹è¯•
npm run test:ci

# ä½¿ç”¨è„šæœ¬è¿è¡Œæµ‹è¯•
./scripts/test.sh                # å•æ¬¡è¿è¡Œ
./scripts/test.sh --watch        # ç›‘å¬æ¨¡å¼
./scripts/test.sh --coverage     # ç”Ÿæˆè¦†ç›–ç‡
./scripts/test.sh --update       # æ›´æ–°å¿«ç…§
```

### æµ‹è¯•æ–‡ä»¶ç»„ç»‡

```
src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ common/
â”‚       â”œâ”€â”€ Button.tsx
â”‚       â””â”€â”€ __tests__/
â”‚           â””â”€â”€ Button.test.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useDebounce.ts
â”‚   â””â”€â”€ __tests__/
â”‚       â””â”€â”€ useDebounce.test.ts
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ home/
â”‚       â”œâ”€â”€ HomePage.tsx
â”‚       â””â”€â”€ __tests__/
â”‚           â””â”€â”€ HomePage.test.tsx
â””â”€â”€ utils/
    â”œâ”€â”€ promptFormatter.ts
    â””â”€â”€ __tests__/
        â””â”€â”€ promptFormatter.test.ts
```

### æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

| ç±»å‹ | ç›®æ ‡ | å½“å‰ |
|------|------|------|
| è¯­å¥è¦†ç›–ç‡ | 40% | - |
| åˆ†æ”¯è¦†ç›–ç‡ | 40% | - |
| å‡½æ•°è¦†ç›–ç‡ | 40% | - |
| è¡Œè¦†ç›–ç‡ | 40% | - |

### ç¼–å†™æµ‹è¯•ç¤ºä¾‹

#### ç»„ä»¶æµ‹è¯•

```typescript
import { render, screen, fireEvent } from '@testing-library/react';
import Button from '../Button';

test('æŒ‰é’®ç‚¹å‡»äº‹ä»¶', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>ç‚¹å‡»</Button>);

    fireEvent.click(screen.getByText('ç‚¹å‡»'));
    expect(handleClick).toHaveBeenCalledTimes(1);
});
```

#### Hook æµ‹è¯•

```typescript
import { renderHook, act } from '@testing-library/react';
import { useDebounce } from '../useDebounce';

test('é˜²æŠ–åŠŸèƒ½', () => {
    jest.useFakeTimers();
    const { result, rerender } = renderHook(
        ({ value }) => useDebounce(value, 500),
        { initialProps: { value: 'initial' } }
    );

    rerender({ value: 'updated' });
    act(() => jest.advanceTimersByTime(500));

    expect(result.current).toBe('updated');
    jest.useRealTimers();
});
```

#### å·¥å…·å‡½æ•°æµ‹è¯•

```typescript
import { formatPromptToMarkdown } from '../promptFormatter';

test('æ ¼å¼åŒ–ä¸º Markdown', () => {
    const data = {
        taskGoal: 'æµ‹è¯•ä»»åŠ¡',
        aiRole: 'æµ‹è¯•è§’è‰²',
        // ...
    };

    const result = formatPromptToMarkdown(data);
    expect(result).toContain('# ä»»åŠ¡ç›®æ ‡');
    expect(result).toContain('æµ‹è¯•ä»»åŠ¡');
});
```

## ğŸ—ï¸ æ„å»º

### å¼€å‘æ„å»º

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆæŒ‡å®šç«¯å£ï¼‰
npm run start:3100
```

### ç”Ÿäº§æ„å»º

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ä½¿ç”¨è„šæœ¬æ„å»ºï¼ˆåŒ…å«æ£€æŸ¥ï¼‰
./scripts/build.sh
```

### æ„å»ºä¼˜åŒ–

#### ä»£ç åˆ†å‰²

é¡¹ç›®ä½¿ç”¨ React.lazy å’Œ Suspense å®ç°ä»£ç åˆ†å‰²ï¼š

```typescript
const HomePage = React.lazy(() => import('./pages/home/HomePage'));
const TemplatesPage = React.lazy(() => import('./pages/templates/TemplatesPage'));
```

#### èµ„æºä¼˜åŒ–

- **å›¾ç‰‡ä¼˜åŒ–**: ä½¿ç”¨ WebP æ ¼å¼ï¼Œå‹ç¼©å›¾ç‰‡
- **å­—ä½“ä¼˜åŒ–**: ä½¿ç”¨ font-display: swap
- **CSS ä¼˜åŒ–**: ä½¿ç”¨ PurgeCSS ç§»é™¤æœªä½¿ç”¨çš„æ ·å¼

#### æ„å»ºåˆ†æ

```bash
# åˆ†ææ„å»ºäº§ç‰©
npm run analyze
```

### ç¯å¢ƒå˜é‡

#### å¼€å‘ç¯å¢ƒ (.env.development)

```env
REACT_APP_API_BASE_URL=http://localhost:8080/api
PORT=3100
BROWSER=none
```

#### ç”Ÿäº§ç¯å¢ƒ (.env.production)

```env
REACT_APP_API_BASE_URL=/api
GENERATE_SOURCEMAP=false
```

## ğŸš€ éƒ¨ç½²

### Docker éƒ¨ç½²

#### æ„å»ºé•œåƒ

```bash
# æ„å»º Docker é•œåƒ
docker build -t cese-kiro:latest .

# ä½¿ç”¨ docker-compose æ„å»º
docker-compose build
```

#### è¿è¡Œå®¹å™¨

```bash
# ä½¿ç”¨ docker-compose è¿è¡Œ
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢å®¹å™¨
docker-compose down
```

### æ‰‹åŠ¨éƒ¨ç½²

#### ä½¿ç”¨éƒ¨ç½²è„šæœ¬

```bash
# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
./scripts/deploy.sh production

# éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ
./scripts/deploy.sh development

# éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒ
./scripts/deploy.sh staging
```

#### éƒ¨ç½²æµç¨‹

1. **æ‹‰å–ä»£ç **: `git pull origin main`
2. **å®‰è£…ä¾èµ–**: `npm ci`
3. **è¿è¡Œæµ‹è¯•**: `npm run test:ci`
4. **ä»£ç æ£€æŸ¥**: `npm run check`
5. **æ„å»ºé¡¹ç›®**: `npm run build`
6. **æ„å»ºé•œåƒ**: `docker build`
7. **å¯åŠ¨æœåŠ¡**: `docker-compose up -d`
8. **å¥åº·æ£€æŸ¥**: éªŒè¯æœåŠ¡å¯è®¿é—®

### Nginx é…ç½®

é¡¹ç›®ä½¿ç”¨ Nginx ä½œä¸º Web æœåŠ¡å™¨ï¼Œé…ç½®æ–‡ä»¶ `nginx.conf` åŒ…å«ï¼š

- **Gzip å‹ç¼©**: å‹ç¼©é™æ€èµ„æº
- **ç¼“å­˜ç­–ç•¥**: é™æ€èµ„æºé•¿æœŸç¼“å­˜
- **SPA è·¯ç”±**: æ”¯æŒå‰ç«¯è·¯ç”±
- **API ä»£ç†**: ä»£ç†åç«¯ API è¯·æ±‚
- **å®‰å…¨å¤´**: æ·»åŠ å®‰å…¨ç›¸å…³çš„ HTTP å¤´

### CI/CD æµç¨‹

#### GitHub Actions

é¡¹ç›®ä½¿ç”¨ GitHub Actions å®ç°è‡ªåŠ¨åŒ– CI/CDï¼š

```yaml
# .github/workflows/ci.yml
- ä»£ç æ£€æŸ¥ (Lint)
- ç±»å‹æ£€æŸ¥ (Type Check)
- æ ¼å¼æ£€æŸ¥ (Format Check)
- è¿è¡Œæµ‹è¯• (Test)
- ä¸Šä¼ è¦†ç›–ç‡ (Coverage)
- æ„å»ºé¡¹ç›® (Build)
- æ„å»ºé•œåƒ (Docker Build)
- æ¨é€é•œåƒ (Docker Push)
```

#### è§¦å‘æ¡ä»¶

- **Push**: main å’Œ develop åˆ†æ”¯
- **Pull Request**: main å’Œ develop åˆ†æ”¯

#### ç¯å¢ƒè¦æ±‚

éœ€è¦åœ¨ GitHub Secrets ä¸­é…ç½®ï¼š

- `DOCKER_USERNAME`: Docker Hub ç”¨æˆ·å
- `DOCKER_PASSWORD`: Docker Hub å¯†ç 

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ä»£ç ä¼˜åŒ–

- âœ… ä½¿ç”¨ React.memo é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
- âœ… ä½¿ç”¨ useMemo å’Œ useCallback ä¼˜åŒ–è®¡ç®—
- âœ… ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµä¼˜åŒ–é¢‘ç¹æ“ä½œ
- âœ… ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å¤„ç†å¤§åˆ—è¡¨

### èµ„æºä¼˜åŒ–

- âœ… ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- âœ… å›¾ç‰‡æ‡’åŠ è½½
- âœ… å­—ä½“ä¼˜åŒ–
- âœ… CSS ä¼˜åŒ–

### ç½‘ç»œä¼˜åŒ–

- âœ… HTTP/2 æ”¯æŒ
- âœ… Gzip å‹ç¼©
- âœ… èµ„æºç¼“å­˜
- âœ… CDN åŠ é€Ÿï¼ˆå¯é€‰ï¼‰

## ğŸ” ç›‘æ§ä¸æ—¥å¿—

### æ€§èƒ½ç›‘æ§

ä½¿ç”¨ Web Vitals ç›‘æ§æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡ï¼š

```typescript
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

getCLS(console.log);
getFID(console.log);
getFCP(console.log);
getLCP(console.log);
getTTFB(console.log);
```

### é”™è¯¯ç›‘æ§

ä½¿ç”¨ ErrorBoundary æ•è· React é”™è¯¯ï¼š

```typescript
<ErrorBoundary>
    <App />
</ErrorBoundary>
```

### æ—¥å¿—æ”¶é›†

å¯é€‰é›†æˆç¬¬ä¸‰æ–¹æœåŠ¡ï¼š

- **Sentry**: é”™è¯¯è¿½è¸ª
- **Google Analytics**: ç”¨æˆ·è¡Œä¸ºåˆ†æ
- **LogRocket**: ä¼šè¯å›æ”¾

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### æ„å»ºå¤±è´¥

```bash
# æ¸…ç†ç¼“å­˜
rm -rf node_modules package-lock.json
npm install

# æ¸…ç†æ„å»ºäº§ç‰©
rm -rf build
npm run build
```

#### æµ‹è¯•å¤±è´¥

```bash
# æ›´æ–°å¿«ç…§
npm test -- --updateSnapshot

# æ¸…ç†æµ‹è¯•ç¼“å­˜
npm test -- --clearCache
```

#### Docker é—®é¢˜

```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker-compose logs -f

# é‡æ–°æ„å»ºé•œåƒ
docker-compose build --no-cache

# æ¸…ç† Docker èµ„æº
docker system prune -a
```

## ğŸ“ æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥

- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç æ£€æŸ¥é€šè¿‡
- [ ] ç±»å‹æ£€æŸ¥é€šè¿‡
- [ ] æ ¼å¼æ£€æŸ¥é€šè¿‡
- [ ] æ„å»ºæˆåŠŸ
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
- [ ] API åœ°å€é…ç½®æ­£ç¡®
- [ ] å¤‡ä»½æ•°æ®åº“ï¼ˆå¦‚æœ‰ï¼‰

### éƒ¨ç½²åæ£€æŸ¥

- [ ] åº”ç”¨å¯æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰é¡µé¢æ­£å¸¸åŠ è½½
- [ ] API è¯·æ±‚æ­£å¸¸
- [ ] ç”¨æˆ·è®¤è¯åŠŸèƒ½æ­£å¸¸
- [ ] æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸
- [ ] æ€§èƒ½æŒ‡æ ‡æ­£å¸¸
- [ ] é”™è¯¯æ—¥å¿—æ­£å¸¸

## ğŸ¯ æœ€ä½³å®è·µ

### æµ‹è¯•æœ€ä½³å®è·µ

1. **æµ‹è¯•ç”¨æˆ·è¡Œä¸ºè€Œéå®ç°ç»†èŠ‚**
2. **ä¿æŒæµ‹è¯•ç®€å•å’Œä¸“æ³¨**
3. **ä½¿ç”¨æœ‰æ„ä¹‰çš„æµ‹è¯•æè¿°**
4. **é¿å…æµ‹è¯•ç¬¬ä¸‰æ–¹åº“**
5. **ä¿æŒæµ‹è¯•ç‹¬ç«‹æ€§**

### éƒ¨ç½²æœ€ä½³å®è·µ

1. **ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®**
2. **å®æ–½è“ç»¿éƒ¨ç½²æˆ–æ»šåŠ¨æ›´æ–°**
3. **ä¿æŒéƒ¨ç½²è„šæœ¬å¹‚ç­‰æ€§**
4. **å®æ–½å¥åº·æ£€æŸ¥**
5. **ä¿ç•™å›æ»šèƒ½åŠ›**

### æ€§èƒ½æœ€ä½³å®è·µ

1. **ç›‘æ§æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡**
2. **å®šæœŸè¿›è¡Œæ€§èƒ½å®¡è®¡**
3. **ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„**
4. **å‡å°‘åŒ…ä½“ç§¯**
5. **ä½¿ç”¨ CDN åŠ é€Ÿé™æ€èµ„æº**

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2024å¹´
**ç»´æŠ¤è€…**: å‰ç«¯å¼€å‘å›¢é˜Ÿ
